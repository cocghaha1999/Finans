(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9546],{17348:(e,t,s)=>{"use strict";s.d(t,{PWAInstallBanner:()=>d});var n=s(86286),a=s(50654),i=s(37942),r=s(27484),l=s(9999),o=s(50161),c=s(46638);function d(){let[e,t]=(0,a.useState)(!1),[s,d]=(0,a.useState)(null),{toast:u}=(0,c.dj)();(0,a.useEffect)(()=>{let e=e=>{e.preventDefault(),d(e),t(!0)},s=()=>{t(!1),u({title:"Uygulama Y\xfcklendi!",description:"CostikFinans artık ana ekranınızda. Uygulamayı a\xe7ın!"})};if(!window.matchMedia("(display-mode: standalone)").matches)return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!localStorage.getItem("pwa-banner-dismissed-ios")&&setTimeout(()=>t(!0),2e3),window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",s),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",s)}},[]);let h=async()=>{if(s)try{let e=await s.prompt();"accepted"===e.outcome&&u({title:"Başarılı!",description:"CostikFinans ana ekranınıza eklendi!"}),d(null),t(!1)}catch(e){console.error("PWA install error:",e),u({title:"Kurulum Hatası",description:"Bir hata oluştu. L\xfctfen tekrar deneyin.",variant:"destructive"})}},m=()=>{t(!1),localStorage.setItem("pwa-banner-dismissed","true")};return e&&s?(0,n.jsx)("div",{className:"fixed top-4 left-4 right-4 z-50 md:left-auto md:right-4 md:max-w-sm",children:(0,n.jsx)(r.Zp,{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 shadow-lg",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"p-2 bg-blue-100 rounded-full flex-shrink-0",children:(0,n.jsx)("img",{src:"/logo.svg",alt:"CostikFinans",className:"h-4 w-4"})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("h3",{className:"font-semibold text-blue-900 text-sm",children:"Uygulamayı İndir"}),(0,n.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"CostikFinans'ı ana ekranınıza ekleyin ve daha hızlı erişin!"}),(0,n.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,n.jsxs)(i.$,{size:"sm",onClick:h,className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1 h-7",children:[(0,n.jsx)(l.A,{className:"h-3 w-3 mr-1"}),"Ekle"]}),(0,n.jsx)(i.$,{size:"sm",variant:"ghost",onClick:m,className:"text-blue-600 hover:text-blue-800 text-xs px-2 py-1 h-7",children:"Kapat"})]})]}),(0,n.jsx)(i.$,{size:"sm",variant:"ghost",onClick:m,className:"p-1 h-6 w-6 text-blue-400 hover:text-blue-600 flex-shrink-0",children:(0,n.jsx)(o.A,{className:"h-4 w-4"})})]})})}):null}},23398:(e,t,s)=>{"use strict";s.d(t,{d:()=>r});var n=s(86286);s(50654);var a=s(9423),i=s(18821);function r(e){let{className:t,...s}=e;return(0,n.jsx)(a.bL,{"data-slot":"switch",className:(0,i.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,n.jsx)(a.zi,{"data-slot":"switch-thumb",className:(0,i.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},26692:()=>{},37867:(e,t,s)=>{"use strict";s.d(t,{w:()=>r});var n=s(86286);s(50654);var a=s(54441),i=s(18821);function r(e){let{className:t,orientation:s="horizontal",decorative:r=!0,...l}=e;return(0,n.jsx)(a.b,{"data-slot":"separator",decorative:r,orientation:s,className:(0,i.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...l})}},92709:(e,t,s)=>{"use strict";s.d(t,{S:()=>z});var n=s(86286),a=s(50654),i=s(37942),r=s(27484),l=s(30334),o=s(41188),c=s(18821),d=s(23176),u=s(39318),h=s(97036),m=s(37224),g=s(43146),x=s(32132),p=s(50161),v=s(91999),w=s(10582),f=s(96020),y=s(94653),b=s(16478),N=s(848),j=s(35084),k=s(43795),S=s(55569),C=s(32017),L=s(38170);class A{static getInstance(){return A.instance||(A.instance=new A),A.instance}addToQueue(e){let t={...e,id:"sync_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),timestamp:Date.now(),retryCount:0};this.syncQueue.push(t),this.saveQueue(),this.notifyListeners(),"undefined"!=typeof navigator&&navigator.onLine&&this.processSyncQueue()}async processSyncQueue(){let e="undefined"!=typeof navigator&&navigator.onLine;if(this.isProcessing||!e||0===this.syncQueue.length)return;this.isProcessing=!0,this.notifyListeners();let t=this.syncQueue[0];try{await this.processItem(t),this.syncQueue.shift(),this.retryDelay=1e3}catch(e){console.error("Sync failed for item:",t.id,e),t.retryCount++,t.lastError=e instanceof Error?e.message:"Unknown error",t.retryCount>=this.maxRetries?(this.syncQueue.shift(),console.error("Max retries reached for sync item:",t.id)):this.retryDelay=Math.min(2*this.retryDelay,3e4)}this.saveQueue(),this.isProcessing=!1,this.notifyListeners(),this.syncQueue.length>0&&setTimeout(()=>{this.processSyncQueue()},this.retryDelay)}async processItem(e){let{addTransaction:t,upsertTransaction:n,removeTransaction:a,upsertPayment:i,removePayment:r,upsertCard:l,removeCard:o,upsertNote:c,removeNote:d}=await Promise.resolve().then(s.bind(s,38170)),u=await this.getCurrentUserId();if(!u)throw Error("No user ID available");switch(e.type){case"transaction":switch(e.action){case"create":await t(u,e.data);break;case"update":await n(u,e.data);break;case"delete":await a(u,e.data.id)}break;case"payment":switch(e.action){case"create":case"update":await i(u,e.data);break;case"delete":await r(u,e.data.id)}break;case"card":switch(e.action){case"create":case"update":await l(u,e.data);break;case"delete":await o(u,e.data.id)}break;case"note":switch(e.action){case"create":case"update":await c(u,e.data);break;case"delete":await d(u,e.data.id)}break;case"budget":return;default:throw Error("Unsupported sync type: ".concat(e.type))}}async getCurrentUserId(){try{try{var e;let{auth:t}=await Promise.resolve().then(s.bind(s,32017)),n=null==t?void 0:null===(e=t.currentUser)||void 0===e?void 0:e.uid;if(n)return n}catch(e){}let t=localStorage.getItem("costik-offline-user");if(t){let e=(0,c.jD)(t,{});if(null==e?void 0:e.uid)return e.uid}let n=localStorage.getItem("userId");if(n)return n;return null}catch(e){return null}}async resolveConflict(e,t,s){let n=e.updatedAt||e.createdAt||0,a=t.updatedAt||t.createdAt||0;return n>a?{strategy:"local"}:a>n?{strategy:"remote"}:{strategy:"merge",data:this.mergeData(e,t,s)}}mergeData(e,t,s){return{...t,...e,id:t.id,createdAt:t.createdAt,updatedAt:Math.max(e.updatedAt||0,t.updatedAt||0)}}addVersion(e){return{...e,version:(e.version||0)+1,updatedAt:Date.now()}}trackChange(e,t,s){let n=this.getLocalChanges();n.push({type:e,action:t,data:this.addVersion(s),timestamp:Date.now()}),localStorage.setItem("sync-changes",JSON.stringify(n.slice(-100))),this.addToQueue({type:e,action:t,data:s})}getLocalChanges(){let e=localStorage.getItem("sync-changes");return e?(0,c.jD)(e,[]):[]}loadQueue(){try{let e=localStorage.getItem("sync-queue");e&&(this.syncQueue=(0,c.jD)(e,[]))}catch(e){console.error("Failed to load sync queue:",e),this.syncQueue=[]}}saveQueue(){localStorage.setItem("sync-queue",JSON.stringify(this.syncQueue))}startSyncProcess(){this.syncIntervalId&&clearInterval(this.syncIntervalId),this.syncIntervalId=setInterval(()=>{"undefined"!=typeof navigator&&navigator.onLine&&this.syncQueue.length>0&&this.processSyncQueue()},5e3)}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){let e={isOnline:"undefined"!=typeof navigator&&navigator.onLine,isSyncing:this.isProcessing,queueSize:this.syncQueue.length,lastSyncTime:0===this.syncQueue.length?new Date:void 0,errors:this.syncQueue.filter(e=>e.lastError).map(e=>e.lastError)};this.listeners.forEach(t=>{try{t(e)}catch(e){console.error("Sync listener error:",e)}})}getStatus(){return{isOnline:"undefined"!=typeof navigator&&navigator.onLine,isSyncing:this.isProcessing,queueSize:this.syncQueue.length,lastSyncTime:0===this.syncQueue.length?new Date:void 0,errors:this.syncQueue.filter(e=>e.lastError).map(e=>e.lastError)}}async forceSyncNow(){"undefined"!=typeof navigator&&navigator.onLine&&await this.processSyncQueue()}clearQueue(){this.syncQueue=[],this.saveQueue(),this.notifyListeners()}getQueueItems(){return[...this.syncQueue]}constructor(){this.syncQueue=[],this.isProcessing=!1,this.retryDelay=1e3,this.maxRetries=3,this.listeners=[],this.syncIntervalId=null,this.loadQueue(),this.startSyncProcess(),window.addEventListener("online",()=>{this.processSyncQueue()}),window.addEventListener("offline",()=>{this.notifyListeners()})}}let D=()=>{let e=A.getInstance();return{addToQueue:e.addToQueue.bind(e),trackChange:e.trackChange.bind(e),getStatus:e.getStatus.bind(e),forceSyncNow:e.forceSyncNow.bind(e),clearQueue:e.clearQueue.bind(e),getQueueItems:e.getQueueItems.bind(e),addListener:e.addListener.bind(e),removeListener:e.removeListener.bind(e)}};function z(e){var t;let{open:s,onClose:A}=e,[z,I]=(0,a.useState)([]),[Q,E]=(0,a.useState)(""),[M,T]=(0,a.useState)(""),H=(0,a.useRef)(null),P=(0,a.useRef)(null),[$,W]=(0,a.useState)({x:20,y:120}),Y=(0,a.useRef)(!1),R=(0,a.useRef)({x:0,y:0}),[K,O]=(0,a.useState)({w:320,h:400}),U=(0,a.useRef)(!1),B=(0,a.useRef)({w:320,h:400,x:0,y:0,direction:""}),[F,_]=(0,a.useState)(!1),[q,J]=(0,a.useState)(""),[X,V]=(0,a.useState)(""),[Z,G]=(0,a.useState)(""),[ee,et]=(0,a.useState)("medium"),[es,en]=(0,a.useState)(!0),[ea,ei]=(0,a.useState)(""),[er,el]=(0,a.useState)(""),[eo,ec]=(0,a.useState)(!1),[ed,eu]=(0,a.useState)(null),[eh,em]=(0,a.useState)(!1),eg=(null===C.auth||void 0===C.auth?void 0:null===(t=C.auth.currentUser)||void 0===t?void 0:t.uid)||"",ex=(0,L.T1)()&&!!eg,{trackChange:ep}=D();(0,a.useEffect)(()=>{if(!s)return;if(ex){let e=(0,L.r1)(eg,e=>{let t=e.map(e=>({...e,updatedAt:e.updatedAt||new Date().toISOString()}));if(I(t),t.length&&!Q){var s;E(t[0].id),T(t[0].title);let e=t[0].contentHtml||"";H.current&&(H.current.innerHTML=e),G(e),V((null===(s=t[0].tags)||void 0===s?void 0:s.join(", "))||"")}});return(0,L.mn)(eg).then(e=>{if(e.length&&!Q){var t;E(e[0].id),T(e[0].title);let s=e[0].contentHtml||"";H.current&&(H.current.innerHTML=s),G(s),V((null===(t=e[0].tags)||void 0===t?void 0:t.join(", "))||"")}}),()=>{e&&e()}}let e=localStorage.getItem("notes"),t=e?(0,c.jD)(e,[]):[];if(I(t),t.length&&!Q){var n;E(t[0].id),T(t[0].title);let e=t[0].contentHtml||"";H.current&&(H.current.innerHTML=e),G(e),V((null===(n=t[0].tags)||void 0===n?void 0:n.join(", "))||"")}},[s,ex]);let ev=(0,a.useMemo)(()=>z.find(e=>e.id===Q)||null,[z,Q]),[ew,ef]=(0,a.useState)("");(0,a.useEffect)(()=>{if(ev&&H.current&&s&&Q!==ew&&Q){var e;if(eo)return;T(ev.title);let t=ev.contentHtml||"";H.current.innerHTML=t,G(t),V((null===(e=ev.tags)||void 0===e?void 0:e.join(", "))||""),ef(Q),em(!1),eu(null),setTimeout(()=>{var e;null===(e=H.current)||void 0===e||e.focus()},50)}},[Q,ev,s,ew,eo]);let ey=e=>{localStorage.setItem("notes",JSON.stringify(e))},eb=async()=>{if(!eo){ec(!0),em(!1);try{var e;let t=(null===(e=H.current)||void 0===e?void 0:e.innerHTML)||Z||"",s={id:Q,title:M||"Yeni Not",contentHtml:t,tags:X.split(",").map(e=>e.trim()).filter(Boolean),updatedAt:new Date().toISOString()};if(ex){let e=await (0,L.upsertNote)(eg,s);!Q&&e&&(E(e),s.id=e),ep("note",Q?"update":"create",s)}else{let e={...s,id:Q||crypto.randomUUID()},t=Q?z.map(t=>t.id===Q?e:t):[e,...z];I(t),E(e.id),ey(t)}eu(new Date)}catch(e){console.error("Not kaydetme hatası:",e),em(!0)}finally{ec(!1)}}},eN=async()=>{if(eh&&!eo&&await eb(),ex){let e=await (0,L.upsertNote)(eg,{id:"",title:"Yeni Not",contentHtml:"",tags:[],updatedAt:new Date().toISOString()});e&&E(e),T("Yeni Not"),H.current&&(H.current.innerHTML="",setTimeout(()=>{var e;null===(e=H.current)||void 0===e||e.focus();let t=document.createRange(),s=window.getSelection();t.selectNodeContents(H.current),t.collapse(!0),null==s||s.removeAllRanges(),null==s||s.addRange(t)},10)),G(""),V(""),em(!1),eu(null)}else{let e={id:crypto.randomUUID(),title:"Yeni Not",contentHtml:"",updatedAt:new Date().toISOString(),tags:[]},t=[e,...z];I(t),E(e.id),T(e.title),H.current&&(H.current.innerHTML="",setTimeout(()=>{var e;null===(e=H.current)||void 0===e||e.focus();let t=document.createRange(),s=window.getSelection();t.selectNodeContents(H.current),t.collapse(!0),null==s||s.removeAllRanges(),null==s||s.addRange(t)},10)),G(""),V(""),em(!1),eu(null),ey(t)}},ej=async()=>{if(!ev)return;ex&&await (0,L.removeNote)(eg,ev.id);let e=z.filter(e=>e.id!==ev.id);I(e),e.length?E(e[0].id):E(""),ey(e)},ek=(e,t)=>{var s;null===(s=H.current)||void 0===s||s.focus(),document.execCommand(e,!1,t)},eS=e=>{et(e),ek("fontSize",{small:"2",medium:"3",large:"4"}[e])};(0,a.useEffect)(()=>{let e=e=>{if(Y.current){let t=e.clientX-R.current.x,s=e.clientY-R.current.y;W({x:Math.min(Math.max(0,t),Math.max(0,(window.innerWidth||0)-K.w-8)),y:Math.min(Math.max(0,s),Math.max(0,(window.innerHeight||0)-40))})}else if(U.current){let t=e.clientX-B.current.x,s=e.clientY-B.current.y,n=B.current.direction,a=B.current.w,i=B.current.h;switch($.x,$.y,n){case"s":i=Math.max(220,Math.min(800,B.current.h+s));break;case"e":a=Math.max(320,Math.min(900,B.current.w+t));break;case"se":a=Math.max(320,Math.min(900,B.current.w+t)),i=Math.max(220,Math.min(800,B.current.h+s))}O({w:a,h:i})}},t=()=>{(Y.current||U.current)&&(Y.current=!1,U.current=!1,document.body.style.userSelect="",document.body.style.cursor="")};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[K.w,K.h]);let eC=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"se";0===e.button&&(U.current=!0,B.current={w:K.w,h:K.h,x:e.clientX,y:e.clientY,direction:t},document.body.style.userSelect="none",document.body.style.cursor="".concat(t,"-resize"),e.preventDefault())},eL=e=>{ei(e.id),el(e.title||"")},eA=async e=>{if(!ea)return;let t=z.find(e=>e.id===ea),s=(er||"").trim();if(ei(""),e&&t){if(ex)await (0,L.upsertNote)(eg,{id:ea,title:s||"Yeni Not",contentHtml:t.contentHtml||"",tags:t.tags||[],updatedAt:new Date().toISOString()}),I(e=>e.map(e=>e.id===ea?{...e,title:s||"Yeni Not"}:e));else{let e=new Date().toISOString(),t=z.map(t=>t.id===ea?{...t,title:s||"Yeni Not",updatedAt:e}:t);I(t),ey(t)}Q===ea&&T(s||"Yeni Not")}};(0,a.useEffect)(()=>{var e,t;if(!s||!Q)return;let n=(null===(e=H.current)||void 0===e?void 0:e.innerHTML)||Z||"",a=z.find(e=>e.id===Q),i=M.trim().length>0||X.trim().length>0||n.trim().length>0;em(a?a.title!==M||(null===(t=a.tags)||void 0===t?void 0:t.join(", "))!==X||a.contentHtml!==n:i)},[M,X,Z,Q,s,z]),(0,a.useEffect)(()=>{let e=e=>{s&&(e.ctrlKey&&"s"===e.key&&(e.preventDefault(),eb()),e.ctrlKey&&"n"===e.key&&(e.preventDefault(),eN()),e.ctrlKey&&"w"===e.key&&(e.preventDefault(),eD()))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s,eh,eo]),(0,a.useEffect)(()=>()=>{eh&&!eo&&eb()},[eh,eo]);let eD=async()=>{eh&&!eo&&await eb(),A()};return s?(0,n.jsx)("div",{style:{position:"fixed",left:window.innerWidth<640?5:$.x,top:window.innerWidth<640?60:$.y,zIndex:60,width:window.innerWidth<640?"calc(100vw - 10px)":K.w,height:window.innerWidth<640?"calc(100vh - 140px)":K.h,maxWidth:window.innerWidth<640?"95vw":"none"},className:"select-none",children:(0,n.jsxs)(r.Zp,{className:"border-border/60 bg-card/95 backdrop-blur relative h-full overflow-hidden",style:{width:"100%"},children:[(0,n.jsxs)("div",{ref:P,onMouseDown:e=>{0===e.button&&(e.target.closest("button, input")||(Y.current=!0,R.current={x:e.clientX-$.x,y:e.clientY-$.y},document.body.style.userSelect="none",document.body.style.cursor="grabbing",e.preventDefault()))},className:"flex items-center justify-between cursor-grab active:cursor-grabbing px-1 sm:px-2 py-1 border-b border-border/50",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 text-xs font-semibold overflow-hidden",children:[(0,n.jsx)(d.A,{className:"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Not Defteri"}),(0,n.jsx)("span",{className:"sm:hidden",children:"Not"}),eo&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,n.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Kaydediliyor..."}),(0,n.jsx)("span",{className:"sm:hidden",children:"•••"})]}),eh&&!eo&&(0,n.jsxs)("div",{className:"flex items-center gap-1 text-xs text-orange-600",children:[(0,n.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Kaydedilmemiş değişiklikler (Ctrl+S ile kaydet)"}),(0,n.jsx)("span",{className:"sm:hidden",children:"*"})]}),ed&&!eh&&!eo&&(0,n.jsxs)("div",{className:"text-xs text-green-600",children:[(0,n.jsxs)("span",{className:"hidden sm:inline",children:["✓ ",new Date(ed).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})," tarihinde kaydedildi"]}),(0,n.jsx)("span",{className:"sm:hidden",children:"✓"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(i.$,{size:"icon",variant:"ghost",className:"h-6 w-6 sm:h-8 sm:w-8 p-0",onClick:()=>_(e=>!e),title:F?"Genişlet":"K\xfc\xe7\xfclt",children:F?(0,n.jsx)(u.A,{className:"h-3 w-3 sm:h-4 sm:w-4"}):(0,n.jsx)(h.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),(0,n.jsx)(i.$,{size:"icon",variant:"ghost",className:"h-6 w-6 sm:h-8 sm:w-8 p-0",onClick:eN,title:"Yeni Not",children:(0,n.jsx)(m.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),(0,n.jsx)(i.$,{size:"icon",variant:"ghost",className:"h-6 w-6 sm:h-8 sm:w-8 p-0",onClick:eb,disabled:eo,title:eo?"Kaydediliyor...":"Kaydet",children:(0,n.jsx)(g.A,{className:"h-3 w-3 sm:h-4 sm:w-4 ".concat(eo?"animate-pulse":"")})}),(0,n.jsx)(i.$,{size:"icon",variant:"ghost",className:"h-6 w-6 sm:h-8 sm:w-8 p-0",onClick:ej,title:"Sil",children:(0,n.jsx)(x.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),(0,n.jsx)(i.$,{size:"icon",variant:"ghost",className:"h-6 w-6 sm:h-8 sm:w-8 p-0",onClick:eD,title:"Kapat",children:(0,n.jsx)(p.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]})]}),!F&&(0,n.jsx)("div",{className:"p-1 sm:p-2 h-full overflow-hidden",style:{width:window.innerWidth<640?"100%":K.w},children:(0,n.jsxs)("div",{className:"grid gap-1 sm:gap-2 h-full",style:{gridTemplateColumns:window.innerWidth<640?"1fr":es?"220px 1fr":"1fr"},children:[es&&window.innerWidth>=640&&(0,n.jsxs)("div",{className:"pr-2 border-r border-border/40 overflow-hidden",children:[(0,n.jsxs)("div",{className:"relative mb-2",children:[(0,n.jsx)(v.A,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,n.jsx)(l.p,{value:q,onChange:e=>J(e.target.value),placeholder:"Notlarda ara...",className:"pl-8 text-xs"})]}),(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)(l.p,{value:X,onChange:e=>V(e.target.value),placeholder:"Etiketler (virg\xfclle)",className:"text-xs"})}),(0,n.jsx)("div",{className:"overflow-auto rounded-md flex-1 touch-pan-y",style:{WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:(0,n.jsx)("ul",{className:"space-y-1",children:z.filter(e=>{if(!q)return!0;let t=q.toLowerCase();return(e.title||"").toLowerCase().includes(t)||(e.contentHtml||"").toLowerCase().includes(t)||(e.tags||[]).some(e=>(e||"").toLowerCase().includes(t))}).map((e,t)=>{let s=e.id===Q;return(0,n.jsx)("li",{children:(0,n.jsxs)("div",{onClick:async()=>{eh&&!eo&&Q!==e.id&&await eb(),E(e.id)},className:"w-full rounded px-2 py-1 border cursor-pointer ".concat(s?"bg-primary/10 border-primary":"border-transparent hover:bg-muted/50"),onDoubleClick:t=>{t.stopPropagation(),eL(e)},children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Sayfa ",t+1]}),ea===e.id?(0,n.jsx)(l.p,{autoFocus:!0,value:er,onChange:e=>el(e.target.value),onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),eA(!0)):"Escape"===e.key&&(e.preventDefault(),eA(!1))},onBlur:()=>eA(!0),className:"h-7 mt-0.5"}):(0,n.jsx)("div",{className:"font-medium truncate",children:e.title||"(Adsız)"})]}),ea!==e.id&&(0,n.jsx)(i.$,{size:"icon",variant:"ghost",className:"shrink-0",title:"Başlığı d\xfczenle",onClick:t=>{t.stopPropagation(),eL(e)},children:(0,n.jsx)(w.A,{className:"h-4 w-4"})})]}),Array.isArray(e.tags)&&e.tags.length>0&&(0,n.jsx)("div",{className:"mt-0.5 flex flex-wrap gap-1",children:e.tags.slice(0,3).map(e=>(0,n.jsxs)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-muted text-muted-foreground",children:["#",e]},e))})]})},e.id)})})})]}),(0,n.jsxs)("div",{className:"pl-2",children:[(0,n.jsx)(l.p,{value:M,onChange:e=>T(e.target.value),placeholder:"Başlık",className:"mb-2"}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-1 mb-2",children:[(0,n.jsx)(i.$,{size:"sm",variant:"outline",onClick:()=>{en(e=>{let t=!e;return O(e=>({w:t?Math.min(e.w+220,900):Math.max(320,e.w-220),h:e.h})),t})},title:es?"Sayfa listesini gizle":"Sayfa listesini g\xf6ster",children:es?(0,n.jsx)(f.A,{className:"h-4 w-4"}):(0,n.jsx)(y.A,{className:"h-4 w-4"})}),(0,n.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>ek("undo"),children:[" ",(0,n.jsx)(b.A,{className:"h-4 w-4"})," "]}),(0,n.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>ek("redo"),children:[" ",(0,n.jsx)(N.A,{className:"h-4 w-4"})," "]}),(0,n.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,n.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>ek("bold"),children:[" ",(0,n.jsx)(j.A,{className:"h-4 w-4"})," "]}),(0,n.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>ek("italic"),children:[" ",(0,n.jsx)(k.A,{className:"h-4 w-4"})," "]}),(0,n.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>ek("underline"),children:[" ",(0,n.jsx)(S.A,{className:"h-4 w-4"})," "]}),(0,n.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(i.$,{size:"sm",variant:"small"===ee?"default":"outline",onClick:()=>eS("small"),children:"K\xfc\xe7\xfck"}),(0,n.jsx)(i.$,{size:"sm",variant:"medium"===ee?"default":"outline",onClick:()=>eS("medium"),children:"Orta"}),(0,n.jsx)(i.$,{size:"sm",variant:"large"===ee?"default":"outline",onClick:()=>eS("large"),children:"B\xfcy\xfck"})]}),(0,n.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(o.J,{htmlFor:"color-text",className:"text-xs text-muted-foreground",children:"Yazı"}),(0,n.jsx)("input",{id:"color-text",type:"color",className:"h-7 w-7 rounded border border-border",onChange:e=>ek("foreColor",e.target.value),title:"Yazı Rengi"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(o.J,{htmlFor:"color-bg",className:"text-xs text-muted-foreground",children:"Arka plan"}),(0,n.jsx)("input",{id:"color-bg",type:"color",className:"h-7 w-7 rounded border border-border",onChange:e=>ek("backColor",e.target.value),title:"Arka Plan"})]})]}),(0,n.jsx)(i.$,{size:"sm",variant:"ghost",onClick:eb,disabled:eo,className:"ml-auto",children:eo?"Kaydediliyor...":"Kaydet"})]}),(0,n.jsx)("div",{ref:H,onInput:()=>{if(!H.current)return;let e=H.current.innerHTML;e!==Z&&G(e)},onTouchStart:e=>{e.stopPropagation()},onTouchMove:e=>{e.stopPropagation()},className:"overflow-auto border border-border/60 rounded-md p-2 bg-background touch-pan-y",style:{height:window.innerWidth<640?"calc(100vh - 250px)":K.h,maxHeight:window.innerWidth<640?"calc(100vh - 250px)":"none",overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y",scrollBehavior:"smooth"},contentEditable:!0,suppressContentEditableWarning:!0})]})]})}),!F&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"absolute right-0 top-1 bottom-1 w-1 cursor-e-resize hover:bg-primary/20",onMouseDown:e=>eC(e,"e")}),(0,n.jsx)("div",{className:"absolute bottom-0 left-1 right-1 h-1 cursor-s-resize hover:bg-primary/20",onMouseDown:e=>eC(e,"s")}),(0,n.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 cursor-se-resize bg-muted/50 hover:bg-primary/50",onMouseDown:e=>eC(e,"se")})]})]})}):null}}}]);